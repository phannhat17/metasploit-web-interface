from flask import Blueprint, jsonify, request
import subprocess
import os
import datetime
from .msf_client import client

# Initialize the Blueprint
exploit = Blueprint('exploit', __name__)

@exploit.route('/options', methods=["GET"])
def method_info():

    module_type = request.args.get('type')
    module_name = request.args.get('name')

    exploit = client.modules.use(module_type, module_name)

    res = {"all_options": exploit.options, "missing_required": exploit.missing_required, 'required': exploit.required, "current_set": exploit.runoptions }
    return jsonify(res)